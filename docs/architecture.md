# Архитектура CRM Gausdo

## Обзор
Система строится по модульному принципу и может быть развернута как монолит с последующим выделением сервисов. Основные слои:
- **Клиентские приложения**: веб-интерфейс для менеджеров и аналитиков, виджеты для встраивания в сторонние порталы.
- **API-шлюз**: единая точка входа с маршрутизацией запросов, авторизацией и rate limiting.
- **Сервисный слой**: набор сервисов для продаж, маркетинга, коммуникаций и отчетности.
- **Хранилище данных**: реляционная БД для транзакционных данных, отдельное аналитическое хранилище для отчетности.
- **Интеграции**: очереди и вебхуки для обмена данными с телефонией, почтовыми сервисами, мессенджерами и биллингом.

## Логические модули
- **Управление клиентами**: профили, сегменты, контакты, история коммуникаций.
- **Воронка продаж**: сделки, стадии, автоматизации, SLA и напоминания.
- **Маркетинг**: кампании, шаблоны сообщений, аудитории, результаты рассылок.
- **Сервис и заявки**: тикеты, категории, приоритеты, SLA, база знаний.
- **Отчеты**: конструктор отчетов, готовые дашборды, экспорт данных.
- **Администрирование**: роли, права, настройки интеграций, аудит действий.

## Технологическое видение
- **Frontend**: SPA на современных фреймворках (Vue/React), дизайн-система с адаптивной версткой.
- **Backend**: REST/GraphQL API, микросервисный подход с сервис-меш для масштабирования, асинхронные очереди для фоновых задач.
- **Данные**: PostgreSQL для основных сущностей, ClickHouse или BigQuery для аналитики, Redis для кэша и сессий.
- **Observability**: централизованные логи, метрики и алерты; трассировка запросов.
- **CI/CD**: автоматические проверки кода, сборка контейнеров, миграции базы.

## Потоки данных
1. Менеджер создаёт сделку в веб-интерфейсе, запрос проходит через API-шлюз к сервису продаж.
2. Сервис продаж сохраняет данные в транзакционную БД и публикует событие в очередь.
3. Сервис уведомлений и автоматизаций подписывается на события и запускает триггеры (письма, задачи, webhooks).
4. Сырые события реплицируются в аналитическое хранилище для отчетов и дашбордов.

## Безопасность
- JWT/Session токены, MFA для администраторов.
- RBAC с гранулярными правами на объекты и операции.
- Шифрование чувствительных данных на уровне приложения и БД.
- Ограничения по IP и интеграция с корпоративными IdP (SAML/OAuth2).

## Масштабирование
- Горизонтальное масштабирование stateless-сервисов.
- Выделение хранилищ по типам нагрузки (OLTP/OLAP).
- Кеширование горячих данных и rate limiting на уровне API.
