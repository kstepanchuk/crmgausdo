# Данные и доменные объекты

## Основные сущности
- **Пользователь**: роли `admin`, `purchaser`, `camp_manager`; поля `role`, `is_active`, `camp_id` (для camp_manager).
- **Заявка на закупку (ProcurementRequest)**: автор, лагерь, статус, суммы, признак `is_archived` (только логическое архивирование).
- **Позиция заявки**: `item_name`, `quantity`, `unit_price`, `line_total`, `tech_specs`; рассчитывается внутри формы повторителя.
- **Шаблон заявки**: заголовок и список позиций для быстрого заполнения новых заявок.
- **Импорт Excel**: временные данные загрузки, проходящие валидацию перед применением к заявке.

## Статусы заявки
Перечисление `RequestStatus`:
- Draft
- Submitted
- Approved
- Rejected
- Ordered
- Completed

Архивирование осуществляется полем `is_archived` без удаления записи.

## Правила доступа и политики
- **Filament** использует `User::canAccessPanel()` после успешного логина; при `false` возвращается 403.
- **ProcurementRequestPolicy**:
  - admin — может обновлять всегда;
  - purchaser — может редактировать Draft, Submitted, Approved, Ordered;
  - camp_manager — только собственные Draft.
- Изменение статуса осуществляется через действия Filament, а не прямое редактирование полей.

## Связи
- Пользователь — Заявка: один-ко-многим (автор). Camp manager видит только свой лагерь.
- Заявка — Позиции: один-ко-многим через повторитель.
- Шаблон — Позиции шаблона: один-ко-многим.

## Нефункциональные требования к данным
- Не применять физическое удаление заявок; использовать архивирование.
- Валидация входных данных при импорте Excel перед сохранением в базу.
- Корректная конфигурация БД: SQLite для разработки, MySQL в продакшене.
- Кэш/сессии через файловое хранилище на продакшене для совместимости с Beget.
